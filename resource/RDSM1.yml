DependsOn:
  - DBSubnetGroup
  - SecurityGroupRDS
  - ParameterGroupM1
  - SecretsManager
Type: AWS::RDS::DBInstance
Properties:
  DBInstanceIdentifier: mm-test-m1
  Engine: MySQL
  EngineVersion: "5.7"
  DBInstanceClass: db.t3.small
  AllocatedStorage: 100
  StorageType: gp2
  MasterUsername:
    Fn::Join:
      - ""
      - - '{{resolve:secretsmanager:'
        - Ref: SecretsManager
        - ':SecretString:username}}'
  MasterUserPassword:
    Fn::Join:
      - ""
      - - '{{resolve:secretsmanager:'
        - Ref: SecretsManager
        - ':SecretString:password}}'
  DBSubnetGroupName:
    Ref: DBSubnetGroup
  PubliclyAccessible: false
  MultiAZ: false
  DBParameterGroupName:
    Ref: ParameterGroupM1
  VPCSecurityGroups:
    - Ref: SecurityGroupRDS
  BackupRetentionPeriod: 1
DeletionPolicy: "Delete"
